webpackJsonp([1,2],{23:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(64),i=n(60),s=n.n(i);new o.a({el:"#app",render:function(t){return t(s.a)}})},24:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(26),i=n.n(o),s=n(25),a=n.n(s),r=n(58),c=n.n(r),d=n(59),l=n.n(d);e.default={ctx:null,img:null,data:function(){return{regionId:1,segIdGen:0,isSetting:!1,isAddCoords:!1,currentSeg:null,original:[0,0],segments:[],results:""}},mounted:function(){var t=localStorage.getItem("segments"),e=localStorage.getItem("regionId");if(e&&(this.regionId=+e),t){var n=JSON.parse(t),o=!0,i=!1,s=void 0;try{for(var r,c=a()(n);!(o=(r=c.next()).done);o=!0){var d=r.value;d.coords=d.coords.map(function(t){return[t.utm_lon,t.utm_lat]})}}catch(t){i=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(i)throw s}}this.segments=n}this.loadImg(this.regionId),setInterval(this.saveSegment(),2e3)},methods:{loadImg:function(t){var e=this,n=this.$refs.canvas.getContext("2d"),o=this.$refs.roads.getContext("2d"),i=new Image;i.onload=function(){n.canvas.height=i.height,n.canvas.width=i.width,o.canvas.height=i.height,o.canvas.width=i.width,n.drawImage(i,0,0,n.canvas.width,n.canvas.height),o.beginPath(),o.moveTo(0,0),o.lineTo(200,200),o.stroke(),e.drawRoads()},i.src=1===t?c.a:l.a,this.regionId=t,this.ctx=o,this.img=i},loadSegs:function(t){var e=this,n=t.target.files[0],o=new FileReader;o.onload=function(t){e.segments=JSON.parse(t.target.result);var n=!0,o=!1,i=void 0;try{for(var s,r=a()(e.segments);!(n=(s=r.next()).done);n=!0){var c=s.value;c.coords=c.coords.map(function(t){return[t.utm_lon,t.utm_lat]})}}catch(t){o=!0,i=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}e.drawRoads()},o.readAsText(n)},settingOriginal:function(){this.isSetting=!0,this.isAddCoords=!1},clickCanvas:function(t){t.ctrlKey||(this.isSetting?(this.original=[t.offsetX,t.offsetY],this.isSetting=!1):this.isAddCoords&&(this.currentSeg.coords.push([t.offsetX-this.original[0],t.offsetY-this.original[1]]),this.drawRoads()))},cleanState:function(){this.isSetting=!1,this.isAddCoords=!1,this.currentSeg=null},rightClickCanvas:function(t){t.preventDefault(),this.cleanState()},addSegment:function(){var t={id:this.segIdGen++,name:"No name",velocity:0,quantity:0,width:2,coords:[]};this.segments.push(t),this.cleanState(),this.currentSeg=t,this.isAddCoords=!0},addCoords:function(t,e){this.isAddCoords=!0,this.isSetting=!1,this.currentSeg=t},removeCoords:function(t){t||(t=this.currentSeg),console.log(t),t.coords.pop(),this.drawRoads()},saveSegment:function(t){var e=JSON.parse(i()(this.segments)),n=!0,o=!1,s=void 0;try{for(var r,c=a()(e);!(n=(r=c.next()).done);n=!0){var d=r.value;d.coords=d.coords.map(function(t){return{utm_lat:t[1],utm_lon:t[0]}})}}catch(t){o=!0,s=t}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}e=i()(e),null===t&&(this.results=e),localStorage.setItem("regionId",this.regionId),localStorage.setItem("segments",e)},drawRoads:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height);var e=!0,n=!1,o=void 0;try{for(var i,s=a()(this.segments);!(e=(i=s.next()).done);e=!0){var r=i.value;if(r.coords[0]){t.beginPath(),t.moveTo(r.coords[0][0],r.coords[0][1]);for(var c=1,d=r.coords.length;c<d;++c){var l=r.coords[c];t.lineTo(l[0],l[1])}t.lineWidth=r.width,t.stroke()}}}catch(t){n=!0,o=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw o}}}}}},57:function(t,e){},58:function(t,e,n){t.exports=n.p+"static/image/region1.cbc7fe0.png"},59:function(t,e,n){t.exports=n.p+"static/image/region2.7d54efe.png"},60:function(t,e,n){n(57);var o=n(61)(n(24),n(62),null,null);t.exports=o.exports},62:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",{staticClass:"tools"},[n("button",{on:{click:function(e){t.loadImg(1)}}},[t._v("Region1")]),t._v(" "),n("button",{on:{click:function(e){t.loadImg(2)}}},[t._v("Region2")]),t._v(" "),n("input",{attrs:{type:"file",name:"img"},on:{change:t.loadSegs}}),t._v(" "),n("button",{on:{click:t.settingOriginal}},[t._v("set original")]),t._v(" "),n("span",[t._v(" "+t._s(t.original))]),t._v(" "),n("button",{on:{click:t.addSegment}},[t._v("Add Segment")]),t._v(" "),n("button",{on:{click:function(e){t.saveSegment(null)}}},[t._v("Save Segment")])]),t._v(" "),n("section",{staticClass:"main",on:{click:function(e){if(!e.ctrlKey)return null;t.removeCoords(null)}}},[n("div",{staticClass:"map"},[n("canvas",{ref:"canvas"}),t._v(" "),n("canvas",{ref:"roads",staticClass:"roads",class:{setting:t.isSetting,add:t.isAddCoords},on:{click:t.clickCanvas,contextmenu:t.rightClickCanvas}})]),t._v(" "),n("div",[n("span",[t._v(t._s(t.results))])]),t._v(" "),n("div",{staticClass:"editor"},t._l(t.segments,function(e){return n("div",{staticClass:"seg",class:{current:e===t.currentSeg}},[n("span",[t._v("id:")]),t._v(" "),n("span",[t._v(t._s(e.id))]),t._v(" "),n("span",[t._v("name:")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"seg.name"}],attrs:{type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),t._v(" "),n("span",[t._v("velocity")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.velocity,expression:"seg.velocity"}],attrs:{type:"text"},domProps:{value:e.velocity},on:{input:function(t){t.target.composing||(e.velocity=t.target.value)}}}),t._v(" "),n("span",[t._v("quantity")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"seg.quantity"}],attrs:{type:"text"},domProps:{value:e.quantity},on:{input:function(t){t.target.composing||(e.quantity=t.target.value)}}}),t._v(" "),n("span",[t._v("width")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.width,expression:"seg.width"}],attrs:{type:"text"},domProps:{value:e.width},on:{input:function(t){t.target.composing||(e.width=t.target.value)}}}),t._v(" "),n("button",{on:{click:function(n){t.addCoords(e,n)}}},[t._v("Add Coords")]),t._v(" "),n("button",{on:{click:function(n){t.removeCoords(e)}}},[t._v("Remove Coords")]),t._v(" "),n("div",{staticClass:"coords"},t._l(e.coords,function(o,i){return n("div",[n("span",[t._v(t._s("#"+i+":"))]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.coords[i],expression:"seg.coords[idx]"}],attrs:{type:"text"},domProps:{value:e.coords[i]},on:{input:function(t){if(!t.target.composing){var n=e.coords,o=i;Array.isArray(n)?n.splice(o,1,t.target.value):e.coords[i]=t.target.value}}}})])}))])}))])])},staticRenderFns:[]}},66:function(t,e,n){t.exports=n(23)}},[66]);